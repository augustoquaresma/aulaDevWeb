<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Consulta CEP — ViaCEP</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container py-5">
    <div class="card shadow-sm">
      <div class="card-body">
        <h2 class="card-title mb-3">Consulta CEP — ViaCEP</h2>
        
        <div class="mb-3">
          <label for="cep" class="form-label">Digite o CEP</label>
          <div class="input-group">
            <input id="cep" type="text" class="form-control" placeholder="00000-000" maxlength="9">
            <button id="btnBuscar" class="btn btn-primary">Buscar</button>
          </div>
          <div class="form-text">Digite apenas números — a máscara será aplicada automaticamente.</div>
        </div>
        
        <div id="msg"></div>
        <pre id="resultado" class="bg-light p-3 rounded" hidden></pre>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    const cepInput = document.getElementById('cep');
    const btnBuscar = document.getElementById('btnBuscar');
    const msg = document.getElementById('msg');
    const out = document.getElementById('resultado');

    // Máscara simples de CEP: 00000-000
    cepInput.addEventListener('input', () => {
      let v = cepInput.value.replace(/\D/g, '').slice(0, 8); // só números
      if (v.length > 5) v = v.slice(0,5) + '-' + v.slice(5);
      cepInput.value = v;
      if (cepInput.value.length === 9) buscarCEP(); // auto-busca
    });

    btnBuscar.addEventListener('click', buscarCEP);

    async function buscarCEP() {
      limpar();
      const cep = cepInput.value.replace(/\D/g, '');
      if (cep.length !== 8) {
        showMsg('CEP inválido. Use 8 números (ex.: 66000-000).', 'danger');
        return;
      }
      showMsg('Buscando...', 'warning');

      try {
        const resp = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
        if (!resp.ok) throw new Error('Falha na requisição.');
        const data = await resp.json();
        if (data.erro) {
          showMsg('CEP não encontrado.', 'danger');
          return;
        }
        showMsg('Sucesso!', 'success');
        out.hidden = false;
        out.textContent = JSON.stringify(data, null, 2);
      } catch (e) {
        showMsg('Erro: ' + e.message, 'danger');
      }
    }

    function limpar() {
      msg.innerHTML = '';
      out.hidden = true;
      out.textContent = '';
    }

    function showMsg(texto, tipo) {
      msg.innerHTML = `<div class="alert alert-${tipo} mt-3">${texto}</div>`;
    }
  </script>
</body>
</html>
